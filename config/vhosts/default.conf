<VirtualHost *:80>

    ServerName {{URL}}
    #ServerAlias {{ALIASES}}
    ServerAdmin admin.localhost

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI}

</VirtualHost>


<IfModule mod_ssl.c>
    <VirtualHost *:443>

        # START Virtual Host Information Directives #
        ServerName {{URL}}
        #ServerAlias {{ALIASES}}
        ServerAdmin admin.localhost
        # END Virtual Host Information Directives #

        # START TLD Redirect #
        #RewriteEngine on
        #RewriteCond %{HTTP_HOST} ^{{URL}}$ [NC]
        #RewriteRule ^(.*)$ https://www.{{URL}}%{REQUEST_URI} [R=301,L]
        # END TLD Redirect #

        # START SSL Directives #
        SSLEngine on

        SSLCertificateFile /etc/apache2/.keys/server.crt
        SSLCertificateKeyFile /etc/apache2/.keys/server.key

        #################################
        #START Application Configuration#
        #################################
        DocumentRoot /var/www/{{DIRNAME}}
        DirectoryIndex index.php

        <Directory "/var/www/{{DIRNAME}}">
            Options Indexes FollowSymLinks Includes ExecCGI
            AllowOverride All
            Require all granted
        </Directory>


        <Location "/xmlrpc.php">
            order deny,allow
            deny from all

            #SetEnvIf Akamai-Origin-Hop [0-9]  proxy_env
            Allow from env=proxy_env
        </Location>


    </VirtualHost>
</IfModule>